% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/05_create_final_diagnosis.R
\name{create_diagnostic_result_rule}
\alias{create_diagnostic_result_rule}
\title{Classify Overall Diagnostic Result from Multiple Rabies Test Columns}
\usage{
create_diagnostic_result_rule(df)
}
\arguments{
\item{df}{A data frame containing any combination of the following columns:
\itemize{
\item \code{lateral_flow_test}: Categorical values (e.g., \code{"Positive"}, \code{"Negative"}).
\item \code{rtqpcr}: Numeric Ct values (or character values coercible to numeric).
\item \code{hmpcr_n405}: HMPCR results (e.g., \code{"Pos1"}, \code{"Pos2"}, \code{"Neg"}).
\item \code{fat}: FAT result.
\item \code{drit}: DRIT result.
}}
}
\value{
A character vector (\code{"Positive"}, \code{"Negative"}, \code{"Inconclusive"}, or \code{NA})
representing the overall diagnostic interpretation for each row.
}
\description{
This function derives an overall diagnostic result based on available test outcomes,
following a defined logical hierarchy across multiple diagnostic assays. It is designed
to work with lateral flow test (LFT), RT-qPCR, hemi-nested PCR (HMPCR),
direct fluorescent antibody test (FAT), and direct rapid immunohistochemical test (DRIT).
}
\details{
The function assumes that categorical variables have already been cleaned and recoded
using standardized dictionary values (e.g., \code{"Positive"}, \code{"Negative"}, \code{"Pos1"}, \code{"Neg"}).
\subsection{Decision Logic}{

The diagnostic result is classified as follows:
\enumerate{
\item \strong{Lateral flow test positive overrides all other results} → returns \code{"Positive"}.
\item If \strong{all available test results are "Negative"}, then returns \code{"Negative"}.
\item If \strong{FAT or DRIT is "Positive"}, returns \code{"Positive"}.
\item If \strong{RT-qPCR Ct value < 32}, returns \code{"Positive"}.
\itemize{
\item If Ct value is between 32–36 (inclusive), returns \code{"Inconclusive"}.
\item If Ct > 36, returns \code{"Negative"}.
}
\item If \strong{HMPCR is "Pos1" or "Pos2"}, returns \code{"Positive"}, or \code{"Negative"} if \code{"Neg"}.
\item If no valid results are available, returns \code{NA}.
}
}
}
\examples{
df <- tibble::tibble(
  lateral_flow_test = c("Positive", "Negative", NA),
  rtqpcr = c("30", "37", "34"),
  hmpcr_n405 = c("Pos1", "Neg", "Neg"),
  fat = c(NA, NA, "Positive"),
  drit = c(NA, "Negative", NA)
)
df$diagnosis <- create_diagnostic_result_rule(df)

}
